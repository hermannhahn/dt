# Help
if [ "$1" = "--help" ] || [ "$1" = "-h" ] || [ "$1" = "/?" ]; then
    echo "Usage: dt [COMMAND]"
    echo ""
    echo "Commands:"
    echo "  init                Initialize a new project"
    echo "  edit                Edit current project"
    echo "  save                Save changes to branch"
    echo "  path                Show path to current branch"
    echo "  publish             Publish current branch"
    echo "  update              Update dt to latest version"
    echo "  version, -v         Show version"
    echo "  --help, -h, /?      Show help"
    echo ""
    echo "Examples:"
    echo "  dt save"
    echo "  dt -v"
    echo "  dt path --help"
    echo ""
    exit 0
fi

BIN_DIR=$(dirname "$0")
DT_DIR=$(dirname "$BIN_DIR")
CALLER_DIR=$PWD
source $DT_DIR/libs/help.sh
source $DT_DIR/libs/intro.sh
source $DT_DIR/libs/git_rules.sh
source $DT_DIR/libs/git.sh
source $DT_DIR/libs/pkg_rules.sh
source $DT_DIR/libs/package.sh
source $DT_DIR/libs/progress_bar.sh
source $DT_DIR/libs/step.sh
source $DT_DIR/libs/update_check.sh

cd $CALLER_DIR
# Check if command exists
if [ ! -f $DT_DIR/cmd/$1.sh ]; then
    step "Command not found!" "sleep 2"
    step "Done!"
    exit 1
fi
cd $CALLER_DIR
cd $git_folder
# If $3 is equal to --help, -h or help, show help
if [ "$2" = "--help" ] || [ "$2" = "-h" ] || [ "$2" = "help" ]; then
    cd $CALLER_DIR
    dt $3 --help
    exit 0
fi
source $DT_DIR/cmd/$1.sh
cd $CALLER_DIR
exit 0
